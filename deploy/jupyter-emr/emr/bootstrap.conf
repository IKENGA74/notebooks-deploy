#!/usr/bin/env bash

yum update
yum -y install nfs-utils

#Get region of EC2 from instance metadata
EC2_REGION="us-west-2"
EFS_FILE_SYSTEM_ID="fs-0ecf06a6"

if [ ! -d /var/lib/jupyter ]; then
  mkdir /var/lib/jupyter
fi

#Create variables for source and target
DIR_SRC=$EFS_FILE_SYSTEM_ID.efs.$EC2_REGION.amazonaws.com
DIR_TGT=/var/lib/jupyter

#Mount EFS file system
mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2 $DIR_SRC:/ $DIR_TGT